<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="硬件专题：TPU">
<meta property="og:url" content="http://example.com/2025/10/06/%E7%A1%AC%E4%BB%B6%E4%B8%93%E9%A2%98%EF%BC%9ATPU/index.html">
<meta property="og:site_name" content="Leon&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/66baf0685c2643343c02470ec6c6c91f.png">
<meta property="og:image" content="http://example.com/images/f4f02daeb2da8a25bad2998916cd8447.png">
<meta property="og:image" content="http://example.com/images/bb67ae8f7be38d468be6bb989ee82159.png">
<meta property="og:image" content="http://example.com/images/pipeline_pointwise-1759748641769-4.gif">
<meta property="og:image" content="http://example.com/images/212a3823252a38a318e9fd37e9002bc3.png">
<meta property="og:image" content="http://example.com/images/5617051d8bf06cf70ec85bde3eac6349.png">
<meta property="og:image" content="http://example.com/images/21d00738a6c6be16eecc7ea3e6cf6016.png">
<meta property="og:image" content="http://example.com/images/71d3c5a5350d1be40d3d119cf8ec967e.png">
<meta property="article:published_time" content="2025-10-06T10:57:55.000Z">
<meta property="article:modified_time" content="2025-10-06T11:05:32.241Z">
<meta property="article:author" content="Leon Dou">
<meta property="article:tag" content="硬件专题">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/66baf0685c2643343c02470ec6c6c91f.png">

<link rel="canonical" href="http://example.com/2025/10/06/%E7%A1%AC%E4%BB%B6%E4%B8%93%E9%A2%98%EF%BC%9ATPU/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>硬件专题：TPU | Leon's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Leon's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">分享一点有趣的技术</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/micropuma" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/10/06/%E7%A1%AC%E4%BB%B6%E4%B8%93%E9%A2%98%EF%BC%9ATPU/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Leon Dou">
      <meta itemprop="description" content="关注领域：体系结构，编译技术">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Leon's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          硬件专题：TPU
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-06 18:57:55 / 修改时间：19:05:32" itemprop="dateCreated datePublished" datetime="2025-10-06T18:57:55+08:00">2025-10-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%A1%AC%E4%BB%B6%E4%B8%93%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">硬件专题</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="/images/66baf0685c2643343c02470ec6c6c91f.png" alt="66baf0685c2643343c02470ec6c6c91f"></p>
<span id="more"></span>

<h2 id="NPU基础架构"><a href="#NPU基础架构" class="headerlink" title="NPU基础架构"></a><font color = brown>NPU基础架构</font></h2><img src="/images/f4f02daeb2da8a25bad2998916cd8447.png" alt="f4f02daeb2da8a25bad2998916cd8447" style="zoom:67%;" />

<p>上图是NPUv2的架构图，仅仅支持推理。整个架构的<strong>存储体系结构</strong>分为三级别：  </p>
<ul>
<li>HMB：片外存储空间（32GiB）</li>
<li>CMEM：片上存储空间，两个tensor core共享区域（128MiB）</li>
<li>VMEM和SMEM：每个tensor core的local存储空间，一个是向量存储（32MiB），一个是标量存储（10MiB）</li>
</ul>
<blockquote>
<p>对比GPU的存储体系结构，CMEM、VMEM和SMEM都比GPU的L1、L2 cache大，但是HBM比GPU的小  </p>
</blockquote>
<p><strong>计算单元上</strong>，主要分为三类：  </p>
<ul>
<li>MXU：矩阵乘处理单元，是tensor core的核心。内部是128x128的脉动阵列。</li>
<li>VPU：向量处理单元，主要处理诸如Relu，Reduction等操作。</li>
<li>Scalar Unit：标量处理单元。</li>
</ul>
<blockquote>
<p>:question:TPU相比GPU，其处理核心远少于GPU的处理核心，所以TPU是如何达到高吞吐同时低功耗的？</p>
</blockquote>
<h2 id="NPU的魔法"><a href="#NPU的魔法" class="headerlink" title="NPU的魔法"></a><font color = brown>NPU的魔法</font></h2><p>NPU为什么高效，主要源自于其两个结构+模型的一个特征：  </p>
<ul>
<li>NPU的脉动阵列 + 流水技术</li>
<li>NPU的AOT编译技术（:key:google的XLA编译器很强大）  </li>
<li>DL模型大多是矩阵乘加运算，比较规整，极其适配脉动阵列</li>
</ul>
<h3 id="脉动阵列"><a href="#脉动阵列" class="headerlink" title="脉动阵列"></a><font color = green>脉动阵列</font></h3><p>下图比较清楚地展示了脉动阵列的原理：   </p>
<p><img src="/images/bb67ae8f7be38d468be6bb989ee82159.png" alt="bb67ae8f7be38d468be6bb989ee82159"></p>
<p>更详细的介绍，参考<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=8zbh4gWGa7I&t=23s">CMU arch课程</a></p>
<p>:question:如何对于脉动阵列做overlap？Scale book中给出了答案：  </p>
  <img src="/images/pipeline_pointwise-1759748641769-4.gif" alt="pipeline_pointwise" style="zoom:50%;" />

<p>这种架构的优点很明确：  </p>
<ul>
<li>节省memory，节省memory bandwith</li>
<li>效率高，多pe互联</li>
</ul>
<p>缺点也很明确：  </p>
<ul>
<li>需要计算任务完美适配脉动阵列，比如<strong>稀疏计算对于Systolic Array就是灾难</strong>。</li>
</ul>
<h3 id="编译-硬件-co-design"><a href="#编译-硬件-co-design" class="headerlink" title="编译-硬件 co-design"></a><font color = green>编译-硬件 co-design</font></h3><p>脉动阵列的另一个大优势是没有cache缓存结构。面对DL任务，编译器需要将模型的每一层静态编译map到脉动阵列上，所以所有内存模型也是编译可确定的。这导致的结果就是编译器可以机制的优化内存复用，传统架构的cache机制在TPU中可以被scratchpad所替代。  </p>
<p>这一部分具体内容十分复杂，google主要研制了XLA编译器，支持AOT&#x2F;JIT混合编译，即AOT编译子图，JIT的方式调用运行。感兴趣读者自行参考<a target="_blank" rel="noopener" href="https://www.tensorflow.org/xla?hl=zh-cn">XLA官方文档</a>。</p>
<h2 id="TPU集群"><a href="#TPU集群" class="headerlink" title="TPU集群"></a><font color = brown>TPU集群</font></h2><p>为了满足google的云推理服务需求（google最早是为了语音ai启动TPU项目，目前主要业务是广告推荐等应用场景），TPU的设计一大核心特点就是易于扩展（scale）。</p>
<p>下表按层次结构组织了TPU的各个核心概念，并概括了其定义、关键技术特性和设计优势。</p>
<table>
<thead>
<tr>
<th align="left">架构层级&#x2F;概念</th>
<th align="left">描述与定义</th>
<th align="left">关键技术&#x2F;拓扑</th>
<th align="left">关键特性与设计优势</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>芯片</strong></td>
<td align="left">计算的基本单元，专为线性代数计算的ASIC。一般<strong>包含两个chip</strong></td>
<td align="left">-</td>
<td align="left">包含矩阵乘单元等核心计算部件。</td>
</tr>
<tr>
<td align="left"><strong>Tray</strong></td>
<td align="left">基础物理封装单元，通常包含<strong>4个TPU芯片</strong>。</td>
<td align="left"><strong>ICI</strong></td>
<td align="left">芯片间通过高带宽的ICI互联，形成一个紧密的计算模块。配备主机CPU通过PCIe连接。</td>
</tr>
<tr>
<td align="left"><strong>Rack</strong></td>
<td align="left">物理机架，包含多个Tray（如TPUv4 Rack含4x4x4个芯片）。</td>
<td align="left"><strong>3D Torus</strong> (TPUv4)<br><strong>2D Torus</strong> (v2, v3, v5e)</td>
<td align="left">通过ICI和<strong>OCS</strong>连接芯片，形成立方体结构。OCS提供<strong>环绕连接</strong>，减少通信跳数。</td>
</tr>
<tr>
<td align="left"><strong>Pod (SuperPod)</strong></td>
<td align="left">通过ICI&#x2F;OCS互联的最大TPU集群单元（如TPUv4 Pod含4096芯片）。</td>
<td align="left">3D Torus of Racks</td>
<td align="left">代表单一大规模机器学习训练任务所能使用的最大、最快的计算单元。</td>
</tr>
<tr>
<td align="left"><strong>Slice</strong></td>
<td align="left">在一个Pod内，通过OCS动态划分出的TPU子集。</td>
<td align="left">可配置（立方体、雪茄形等）</td>
<td align="left"><strong>核心灵活性</strong>：<br>• 拓扑即超参数<br>• 非连续分配<br>• 可重构拓扑（支持扭曲环面）</td>
</tr>
<tr>
<td align="left"><strong>Multi-Pod</strong></td>
<td align="left">多个Pod通过数据中心网络联合工作。</td>
<td align="left">DCN</td>
<td align="left">用于超大规模训练，Pod间通信带宽低于ICI。</td>
</tr>
<tr>
<td align="left"><strong>ICI</strong></td>
<td align="left"><strong>芯片间互联</strong>，TPU专用的高速内部网络。</td>
<td align="left">2D&#x2F;3D Torus</td>
<td align="left">提供极高带宽和低延迟，使TPU芯片能像统一内存系统一样工作。</td>
</tr>
<tr>
<td align="left"><strong>OCS</strong></td>
<td align="left"><strong>光电路交换</strong>，用于灵活的芯片连接。</td>
<td align="left">-</td>
<td align="left"><strong>三大优势</strong>：<br>• 环绕连接优化网络<br>• 实现非连续切片<br>• 支持拓扑重构</td>
</tr>
</tbody></table>
<h4 id="Chip"><a href="#Chip" class="headerlink" title="Chip"></a>Chip</h4><p>chip结构如下：两个TPU core，搭配一个共享的HBM。</p>
<img src="/images/212a3823252a38a318e9fd37e9002bc3.png" alt="212a3823252a38a318e9fd37e9002bc3" style="zoom: 33%;" />

<h4 id="Tray"><a href="#Tray" class="headerlink" title="Tray"></a>Tray</h4><p>一个Tray一般有4个Chip，并有host通过PCIe总线连接控制。</p>
<img src="/images/5617051d8bf06cf70ec85bde3eac6349.png" alt="5617051d8bf06cf70ec85bde3eac6349" style="zoom:33%;" />

<h3 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h3><p>在一个pod中，每个chip可以和邻居4个方向或6个方向（3D 拓扑网络，专业名称ICI）互联。</p>
<img src="/images/21d00738a6c6be16eecc7ea3e6cf6016.png" alt="21d00738a6c6be16eecc7ea3e6cf6016" style="zoom:33%;" />

<h4 id="MultiPod"><a href="#MultiPod" class="headerlink" title="MultiPod"></a>MultiPod</h4><p>Pod里面的chip数可以很大，最大的（superpod）可以达到16x16x16（TPU v4）以及16x20x28（TPU v5P）。一个可重构cube是4x4x4，每个pod都是由这些cube组成，通过 optical wraparound links互联（是可重构的）。  </p>
<img src="/images/71d3c5a5350d1be40d3d119cf8ec967e.png" alt="71d3c5a5350d1be40d3d119cf8ec967e" style="zoom:33%;" />

<p>对于TPU和GPU互联机制，书中的一些思考：  </p>
<blockquote>
<p>This nearest-neighbor connectivity is a key difference between TPUs and GPUs. GPUs are connected with a hierarchy of switches that approximate a point-to-point connection between every GPU, rather than using local connections like a TPU. Typically, GPUs within a node (8 GPUs for H100 or as many as 72 for B200 NVL72) are directly connected, while larger topologies require O(log(N)) hops between each GPU. On the one hand, that means GPUs can send arbitrary data within a small number of hops. On the other hand, TPUs are dramatically cheaper (since NVLink switches are expensive), simpler to wire together, and can scale to much larger topologies because the number of links per device and the bandwidth per device is constant. Read more <a target="_blank" rel="noopener" href="https://jax-ml.github.io/scaling-book/gpus/#networking">here</a>.</p>
</blockquote>
<p>提炼一下：  </p>
<ul>
<li>GPU有平均最好的P2P互联hop数</li>
<li>GPU的NVLink带宽高，速度快，但是昂贵（主要是NVLink的交换机贵）</li>
<li>TPU的互联数对于每个点是恒定的，可扩展性极强</li>
<li>TPU互联有明显的空间特性（邻居特性），完美适配AI任务</li>
</ul>
<p>对这块感兴趣的读者，可进一步深入<a target="_blank" rel="noopener" href="https://jax-ml.github.io/scaling-book/tpus/">Scaling Book: all about TPUs</a> 和<a target="_blank" rel="noopener" href="https://jax-ml.github.io/scaling-book/gpus/">TPU vs. GPU</a></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a><font color = brown>参考资料</font></h2><ol>
<li><a target="_blank" rel="noopener" href="https://henryhmko.github.io/posts/tpu/tpu.html">Deep Dive into TPU</a> :key: </li>
<li><a target="_blank" rel="noopener" href="https://jax-ml.github.io/scaling-book/">JAX Scaling book</a></li>
</ol>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%A1%AC%E4%BB%B6%E4%B8%93%E9%A2%98/" rel="tag"># 硬件专题</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/10/03/Paper-Reading-All-about-CGRA/" rel="prev" title="Paper Reading: All about CGRA">
      <i class="fa fa-chevron-left"></i> Paper Reading: All about CGRA
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#NPU%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84"><span class="nav-number">1.</span> <span class="nav-text">NPU基础架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NPU%E7%9A%84%E9%AD%94%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">NPU的魔法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%89%E5%8A%A8%E9%98%B5%E5%88%97"><span class="nav-number">2.1.</span> <span class="nav-text">脉动阵列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E8%AF%91-%E7%A1%AC%E4%BB%B6-co-design"><span class="nav-number">2.2.</span> <span class="nav-text">编译-硬件 co-design</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TPU%E9%9B%86%E7%BE%A4"><span class="nav-number">3.</span> <span class="nav-text">TPU集群</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Chip"><span class="nav-number">3.0.1.</span> <span class="nav-text">Chip</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Tray"><span class="nav-number">3.0.2.</span> <span class="nav-text">Tray</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pod"><span class="nav-number">3.1.</span> <span class="nav-text">Pod</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MultiPod"><span class="nav-number">3.1.1.</span> <span class="nav-text">MultiPod</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">4.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Leon Dou</p>
  <div class="site-description" itemprop="description">关注领域：体系结构，编译技术</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Leon Dou</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">326k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">4:56</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'Ov23liFsw1lTgh0R8s8H',
      clientSecret: '1f947cb0d107ba1ffbcad8c25688c075224fff36',
      repo        : 'micropuma.github.io',
      owner       : 'micropuma',
      admin       : ['micropuma'],
      id          : '03082786d55c768c108ffb0d3859855e',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

    </div>
</body>
</html>
